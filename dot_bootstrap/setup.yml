---
- name: Bootstrap Debian system with essential tools
  hosts: localhost
  become: yes
  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes

    - name: Install packages
      apt:
        name:
          - git
          - curl
          - wget
          - vim
          - btop
          - build-essential
          - python3-pip
          - python3-venv
          - bat
          - ripgrep
          - fzf
          - neovim
          - zsh
          - thefuck
          - zathura
          - tealdeer
          - cargo
        state: present

    - name: Install oh-my-zsh
      become: false
      shell: |
        RUNZSH=no CHSH=no KEEP_ZSHRC=yes sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
      args:
        creates: ~/.oh-my-zsh

    - name: Install nvm
      become: false
      shell: |
        curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
      args:
        creates: ~/.config/nvm

    - name: Install Node.js using nvm
      become: false
      shell: |
        . ~/.config/nvm/nvm.sh
        nvm install --lts
      args:
        creates: ~/.config/nvm/versions/node
    
    - name: Install zsh-autosuggestions
      become: false
      git:
        repo: "https://github.com/zsh-users/zsh-autosuggestions.git"
        dest: "~/.oh-my-zsh/custom/plugins/zsh-autosuggestions"

    - name: Install zsh-syntax-highlighting
      become: false
      git:
        repo: "git clone https://github.com/zsh-users/zsh-syntax-highlighting.git"
        dest: "~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting"
